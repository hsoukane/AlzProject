package upec.alzproject;
import upec.PatientRecord;
import upec.Symptom;
import upec.MedicalExamination;
import upec.NeuropsychologicalParameter;
import upec.Assignement;
import upec.Diagnosis;

rule "inserting patient clinical examinations into the wm"
ruleflow-group"NeurologyService1"
salience 4
no-loop true
when
patient:upec.PatientRecord( exams:medicalExaminations)
exam:upec.MedicalExamination( )from exams
then
insertLogical(exam);
System.out.println("insert fact: "+ exam.getName()+ "result:"+exam.getResult());
end

rule"inserting neuropsychological parameters into the wm"
ruleflow-group"NeurologyService1"
salience 4
no-loop true
when
patient:upec.PatientRecord( neuroparameters:neuropsychologicalParameters)
neuroparameter: NeuropsychologicalParameter() from neuroparameters
then
insertLogical(neuroparameter);
System.out.println("insert fact: "+ neuroparameter.getName()+ "Value:"+ neuroparameter.getValue());
end

rule "Neurology diagnosis1"
ruleflow-group"NeurologyService1"
salience 4
no-loop true
when
exam:upec.MedicalExamination((name=="IRM" || name=="CT scanner"  ) && result=="Cortical atrophy")
diagnosis: upec.Diagnosis(this!=null )
then
diagnosis.setValue("Alzheimer");
System.out.println("Diagnosis: "+ diagnosis.getValue());
end

rule"Neurology diagnosis2"
ruleflow-group"NeurologyService1"
salience 4
no-loop true
when
exam:upec.MedicalExamination(name=="Brain biopsy" && result!="Nothing")
diagnosis: upec.Diagnosis(this!=null )
then
diagnosis.setValue("Presence of dementia other than Alzheimer's");
System.out.println("Diagnosis: "+ diagnosis.getValue());
end


rule"Neurology diagnosis3"
ruleflow-group"NeurologyService1"
salience 4
no-loop true
when
exam:upec.MedicalExamination(name=="Electroencephalogram" && result!="Nothing")
diagnosis: upec.Diagnosis(this!=null )
then
diagnosis.setValue("Presence of dementia other than Alzheimer's");
System.out.println("Diagnosis: "+ diagnosis.getValue());
end

rule"Neurology diagnosis4"
ruleflow-group"NeurologyService1"
salience 4
no-loop true
when
exam:upec.MedicalExamination(name=="CSF analysis" && result!="Nothing")
diagnosis: upec.Diagnosis(this!=null )
then
diagnosis.setValue("Presence of dementia other than Alzheimer's");
System.out.println("Diagnosis: "+ diagnosis.getValue());
end

rule"Neurology diagnosis5"
ruleflow-group"NeurologyService1"
salience 4
no-loop true
when
exam:upec.MedicalExamination((name=="IRM" || name=="CT scanner" ) && result!="Nothing" && result!="Cortical atrophy")
diagnosis: upec.Diagnosis(this!=null )
then
diagnosis.setValue("Presence of dementia other than Alzheimer's");
System.out.println("Diagnosis: "+ diagnosis.getValue());
end

rule"Neurology diagnosis6"
ruleflow-group"NeurologyService1"
salience 4
no-loop true
when
exam1:upec.MedicalExamination((name=="IRM" || name=="CT scanner" ) && result=="Nothing")
exam2:upec.MedicalExamination(name=="Brain biopsy" && result=="Nothing")
exam3:upec.MedicalExamination(name=="Electroencephalogram" && result=="Nothing")
exam4:upec.MedicalExamination(name=="CSF analysis" && result=="Nothing")
mmse:upec.NeuropsychologicalParameter(name=="MMSE score" && value<24 )
diagnosis: upec.Diagnosis(this!=null )
then
diagnosis.setValue("Alzheimer");
System.out.println("Diagnosis: "+ diagnosis.getValue());
end

rule"Neurology diagnosis7"
ruleflow-group"NeurologyService1"
salience 2
no-loop true
when
exam1:upec.MedicalExamination((name=="IRM" || name=="CT scanner" ) && result=="Nothing")
exam2:upec.MedicalExamination(name=="Brain biopsy" && result=="Nothing")
exam3:upec.MedicalExamination(name=="Electroencephalogram" && result=="Nothing")
exam4:upec.MedicalExamination(name=="CSF analysis" && result=="Nothing")
mmse:upec.NeuropsychologicalParameter(name=="MMSE score" && value>=24 )
diagnosis: upec.Diagnosis(this!=null )
then
diagnosis.setValue("No case of demantia");
System.out.println("Diagnosis: "+ diagnosis.getValue());
end

rule"Depression detection"
ruleflow-group"NeurologyService1"
salience 2
no-loop true
when
gds: upec.NeuropsychologicalParameter(name=="GDS score" && value>=9 )
diagnosis1:upec.Diagnosis(value=="No case of demantia"||value=="Alzheimer"|| value=="Presence of dementia other than Alzheimer's")
diagnosis2:upec.Diagnosis( this!=null)
then
diagnosis2.setValue("Depression, behavioral and emotional disorders");
System.out.println("Diagnosis: "+ diagnosis2.getValue());
end

rule"Alzheimer stage 1"
ruleflow-group"NeurologyService1"
salience 2
no-loop true
when
diagnosis1:upec.Diagnosis(value=="Alzheimer")
mmse:upec.NeuropsychologicalParameter( name=="MMSE score" && value>20)
diagnosis3:upec.Diagnosis( this!=null)
then
diagnosis3.setValue("Alhzeimer mild stage");
System.out.println("Diagnosis3: "+ diagnosis3.getValue());
end

rule"Alzheimer stage 2"
ruleflow-group"NeurologyService1"
salience 2
no-loop true
when
diagnosis1:upec.Diagnosis(value=="Alzheimer")
mmse:upec.NeuropsychologicalParameter( name=="MMSE score" && value>10 && value <20)
diagnosis3:upec.Diagnosis( this!=null)
then
diagnosis3.setValue("Alhzeimer moderate stage");
System.out.println("Diagnosis3: "+ diagnosis3.getValue());
end


rule"Alzheimer stage 3"
ruleflow-group"NeurologyService1"
salience 2
no-loop true
when
diagnosis1:upec.Diagnosis(value=="Alzheimer")
mmse:upec.NeuropsychologicalParameter(name=="MMSE score" && value <10)
diagnosis3:upec.Diagnosis( this!=null)
then
diagnosis3.setValue("Alhzeimer severe stage");
System.out.println("Diagnosis3: "+ diagnosis3.getValue());
end

